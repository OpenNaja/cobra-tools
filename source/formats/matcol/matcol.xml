<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE fileformat>
<fileformat>

	<xi:include href="../ovl_base/ovl_base.xml" xmlns:xi="http://www.w3.org/2001/XInclude" xpointer="xpointer(*/*)" />

	<struct name="Layer" inherit="MemStruct">
        <field name="layer_name" type="Pointer" template="ZString"/>
        <field name="zero_0" type="uint64" default="0" optional="True"/>
        <field name="zero_1" type="uint64" default="0" optional="True"/>
        <field name="float_attributes" type="ArrayPointer" template="FloatAttrib" arg="float_attributes_count"/>
        <field name="float_attributes_count" type="uint64"/>
        <field name="zero_2" type="uint64" default="0" optional="True"/>
        <field name="zero_3" type="uint64" default="0" optional="True"/>
        <field name="bool_attributes" type="ArrayPointer" template="BoolAttrib" arg="bool_attributes_count"/>
        <field name="bool_attributes_count" type="uint64"/>
    </struct>

    <struct name="FloatAttrib" inherit="MemStruct">
        <field name="attrib_name" type="Pointer" template="ZString"/>
        <field name="flags" type="byte" arr1="4"/>
        <field name="value" type="float" arr1="4"/>
        <field name="padding" type="uint" default="0" optional="True"/>
    </struct>

    <struct name="BoolAttrib" inherit="MemStruct">
        <field name="attrib_name" type="Pointer" template="ZString"/>
        <field name="attrib" type="byte" arr1="4"/>
        <field name="padding" type="uint" default="0" optional="True"/>
    </struct>

	<struct name="Texture" inherit="MemStruct">
		<field name="fgm name" type="Pointer" template="ZString">first fgm slot</field>
        <field name="texture suffix" type="Pointer" template="ZString"/>
        <field name="texture type" type="Pointer" template="ZString"/>
    </struct>

	<struct name="MatcolRoot" inherit="MemStruct">
        root_entry data
        <field name="main" type="Pointer" template="RootFrag"/>
		<field name="one" type="uint64" >always 1</field>
    </struct>

	<struct name="RootFrag" inherit="MemStruct">
        <field name="mat_type" type="uint64">(3=variant, 2=layered)</field>
        <field name="textures" type="ArrayPointer" template="Texture" arg="tex_count"/>
        <field name="tex_count" type="uint64"/>
        <field name="materials" type="ArrayPointer" template="Layer" arg="mat_count"/>
        <field name="mat_count" type="uint64"/>
        <field name="unk" type="uint64" default="0" optional="True"/>
    </struct>

</fileformat>
